webpackJsonp([1],{"0bdn":function(e,t){},"5JrK":function(e,t){},K6Ts:function(e,t){},PNa4:function(e,t){},TdF4:function(e,t){},UaLj:function(e,t){},WjiO:function(e,t){},ZeVD:function(e,t){},"d8/S":function(e,t){},"f/sI":function(e,t){},g7Mu:function(e,t){},tvR6:function(e,t){},u1Ef:function(e,t){},x35b:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7+uW"),o=r("u0hM"),s={user:void 0,accessToken:void 0,expirationTime:void 0},i=Object(o.a)().module("auth",Object.assign({},s));function a(e,t){Object.assign(e,t)}var u=i.state(),l={get state(){return u()},commitAuthorized:i.commit(function d(e,t){console.log("authorized",t.user),a(e,t)},"authorized"),commitTokenReceived:i.commit(function c(e,t){console.log("tokenReceived"),a(e,t)},"tokenReceived"),commitLogout:i.commit(function m(e){console.log("logout",l.state.user.username),a(e,s)},"logout")},f=l,p={ref:"asideMenu",router:!0,items:[{index:"/",title:"Main",icon:"el-icon-menu"},{index:"/users",title:"Users",icon:"fas fa-users"},{index:"/orders",title:"Orders",icon:"fas fa-list-ul"}]},h=n.default.extend({name:"TheAside",data:function(){return{activeIndex:this.$router.currentRoute.path,isCollapse:window.innerWidth<=768,asideMenu:p}},created:function(){var e=this;window.onresize=function(){e.isCollapse=window.innerWidth<=768}},mounted:function(){},destroyed:function(){window.onresize=null},watch:{$route:function(e,t){this.activeIndex=e.path}}}),v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.asideMenu?r("el-aside",[r("el-menu",{ref:e.asideMenu.ref,attrs:{"default-active":e.activeIndex,router:e.asideMenu.router,collapse:e.isCollapse}},[e._l(e.asideMenu.items,function(t){return[t.subitems?[e.isCollapse?e._l(t.subitems,function(t){return r("el-menu-item",{key:t.index,attrs:{index:t.index}},[r("i",{class:t.icon}),e._v(" "),r("span",[e._v(e._s(t.title))])])}):[r("el-submenu",{attrs:{index:t.index}},[r("template",{slot:"title"},[r("i",{class:t.icon}),e._v(" "),r("span",[e._v(e._s(t.title))])]),e._v(" "),e._l(t.subitems,function(t){return[r("el-menu-item",{attrs:{index:t.index}},[r("i",{class:t.icon}),e._v(" "),r("span",[e._v(e._s(t.title))])])]})],2)]]:[r("el-menu-item",{attrs:{index:t.index}},[r("i",{class:t.icon}),e._v(" "),r("span",[e._v(e._s(t.title))])])]]})],2)],1):e._e()},staticRenderFns:[]};var g=r("VU/8")(h,v,!1,function b(e){r("UaLj")},"data-v-f71c84cc",null).exports,_=r("UMwo"),w=r.n(_),F=r("zL8q"),x=r.n(F),y=r("Au9i"),O=r.n(y),k=new w.a(navigator.userAgent),U=function(){function e(){}return e.showError=function(e){F.Message.error(e.name+": "+e.message)},e.showConfirmMessage=function(e,t){var r={confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"};return k.phone()?y.MessageBox.confirm(t,e,r):F.MessageBox.confirm(t,e,r)},e}(),A=r("/ocq"),R=r("NYxO"),M=r("424j"),L=r("mtWM"),C=r.n(L),E=function(){function e(){}return e.checkLifetime=function(){return new Promise(function(e,t){var r=function(e){return console.error(e.name+": "+e.message),t(e)};if(!f.state.expirationTime)return r(new Error("have no expirationTime"));var n=new Date(1e3*f.state.expirationTime).getTime(),o=(new Date).getTime();if(n<o)return r(new Error("token expire"));return Math.floor((n-o)/1e3)>86400?e():(console.log("token expire at",new Date(n)),console.log("have to exchange access token"),D.exchangeToken().then(function(t){return e(t)}).catch(function(e){return r(e)}))})},e}(),S=function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),$=C.a.create();function T(e){var t=f.state.accessToken;return t&&(e.headers.Authorization="Bearer "+t),e}function P(e){return Promise.reject(e)}$.defaults.baseURL="https://gpi-api.gogbajbobo.ru",$.interceptors.request.use(function(e){switch(S.log("send request",e.method,e.url),e.url){case"/auth/login":return e;case"/auth/token":return T(e);default:return E.checkLifetime().then(function(){return T(e)}).catch(P)}},P),$.interceptors.response.use(function(e){return S.log(e.config.method+" "+e.config.url+" response:"),S.log(e),e},function(e){return e.response&&401===e.response.status&&(ie(),Ie.push({name:"Login"})),P(e)});var D=function(){function e(){}return e.login=function(e,t){var r={username:e,password:t,userAgent:navigator.userAgent};return $.post("/auth/login",r).then(function(e){return f.commitAuthorized(e.data)}).catch(P)},e.exchangeToken=function(){return $.get("/auth/token").then(function(e){return f.commitTokenReceived(e.data)}).catch(P)},e.register=function(e,t,r){var n={username:e,password:t,roles:r};return $.post("/auth/register",n).catch(P)},e.getUsers=function(){return $.get("/api/users").then(function(e){return e.data.users}).catch(P)},e.getUserById=function(e){return $.get("/api/users/"+e).then(function(e){return e.data.user}).catch(P)},e.deleteUser=function(e){return $.delete("/api/users/"+e).then(function(e){return e.data}).catch(P)},e.getRoles=function(){return $.get("/api/roles").then(function(e){return e.data.roles}).catch(P)},e.getOrders=function(){return $.get("/api/orders").then(function(e){return e.data.orders}).catch(P)},e.addOrder=function(e){return $.post("/api/orders",{ordername:e}).catch(P)},e.updateOrder=function(e,t,r){return $.put("/api/orders/"+e,{ordername:t,approved:r}).catch(P)},e.deleteOrder=function(e){return $.delete("/api/orders/"+e).catch(P)},e}(),j={rolesList:[]},q=Object(o.a)().module("roles",Object.assign({},j));var V=q.state(),I={get state(){return V()},commitFillUpRolesList:q.commit(function N(e,t){e.rolesList=t},"fillUpRolesList"),dispatchGetRoles:q.dispatch(function z(){D.getRoles().then(function(e){return I.commitFillUpRolesList(e)}).catch(function(e){return S.error(e.message)})}),commitLogout:q.commit(function W(e){Object.assign(e,j)},"logout")},B=I,Y={orders:void 0},G=Object(o.a)().module("orders",Object.assign({},Y));var H=G.state(),K={get state(){return H()},commitFillUpOrders:G.commit(function J(e,t){e.orders=t},"fillUpOrders"),commitLogout:G.commit(function Z(e){Object.assign(e,Y)},"logout"),dispatchGetOrders:G.dispatch(function Q(){if(K.state.orders)return Promise.resolve(K.state.orders);D.getOrders().then(function(e){return K.commitFillUpOrders(e)}).catch(U.showError)}),dispatchRefreshOrders:G.dispatch(function X(){return K.commitFillUpOrders(void 0),K.dispatchGetOrders()}),dispatchAddOrder:G.dispatch(function ee(e,t){var r=t.ordername;return D.addOrder(r).then(K.dispatchRefreshOrders).catch(function(e){return Promise.reject(e)})}),dispatchUpdateOrder:G.dispatch(function te(e,t){var r=t.orderId,n=t.ordername,o=t.approved;return D.updateOrder(r,n,o).then(K.dispatchRefreshOrders).catch(function(e){return Promise.reject(e)})}),dispatchDeleteOrder:G.dispatch(function re(e,t){var r=t.orderId;return D.deleteOrder(r).then(K.dispatchRefreshOrders).catch(function(e){return Promise.reject(e)})})},ne=K;n.default.use(R.b);var oe={plugins:[Object(M.a)()],strict:!1},se=Object(o.a)().vuexStore(oe);function ie(){f.commitLogout(),B.commitLogout(),ne.commitLogout()}var ae=n.default.extend({name:"Main"}),ue={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"main-content"},[t("h1",[this._v("Main")]),this._v(" "),t("p",[this._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque id nulla dolor. Aliquam volutpat non eros nec mattis. Nam gravida, justo quis tincidunt blandit, urna magna faucibus lectus, sit amet volutpat nulla lorem quis leo. Duis nec dolor sagittis, tincidunt metus at, vehicula leo. Quisque suscipit nec ipsum in bibendum. Sed posuere, massa at faucibus elementum, nunc magna fringilla turpis, vitae ullamcorper augue elit at arcu. Sed et ligula eu lorem efficitur feugiat. Nam mollis mauris laoreet magna facilisis convallis. Morbi condimentum augue enim, vel bibendum eros congue ac. Suspendisse tincidunt posuere mi, quis volutpat ipsum vulputate quis. Etiam eget libero non turpis efficitur laoreet. Sed posuere nibh nulla, eu consequat diam mollis nec. Nulla justo ex, suscipit eget aliquet eu, malesuada vel neque.")])])}]};var le=r("VU/8")(ae,ue,!1,function de(e){r("ZeVD")},"data-v-5d25ae56",null).exports,ce=n.default.extend({name:"Login",data:function(){return{loginForm:{username:"",password:""},busy:!1,rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}]}}},methods:{submitForm:function(){var e=this;this.$refs.loginForm.validate().then(function(){e.busy=!0,D.login(e.loginForm.username,e.loginForm.password).then(function(){return e.$router.push({name:"Main"})}).catch(U.showError).then(function(){return e.busy=!1})}).catch(function(){return console.error("login form validation fail")})}}}),me={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"loginForm",attrs:{model:e.loginForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[r("h1",[e._v("Login page")]),e._v(" "),r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:"Username"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Login")])],1)],1)},staticRenderFns:[]};var fe=r("VU/8")(ce,me,!1,function pe(e){r("u1Ef")},"data-v-97f9f9b6",null).exports,he=function(e){return e.roles.split(",").includes("admin")},ve=function(e){return e.roles.split(",").includes("user")},ge=n.default.extend({name:"Profile",data:function(){return{user:{},editMode:!1,profileForm:{username:"",password:""},busy:!1,rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{min:1,message:"Please enter password",trigger:"blur"}]},isAdmin:!1,isSelf:!1}},props:["id"],created:function(){this.isAdmin=he(f.state.user),this.setupComponent()},methods:{setupComponent:function(){var e=this;this.isSelf=this.id===f.state.user.id,this.isAdmin&&this.id&&!this.isSelf?D.getUserById(this.id).then(function(t){t?(e.user=t,e.profileForm.username=e.user.username):e.profileForm.username=f.state.user.username}).catch(function(e){return console.error(e.message)}):(this.user=f.state.user,this.profileForm.username=f.state.user.username)},editButtonPressed:function(){this.editMode=this.isAdmin},deleteButtonPressed:function(){var e=this;U.showConfirmMessage("Delete confirmation","Are you sure to delete this user?").then(function(){D.deleteUser(e.id).then(function(){return e.$router.push({name:"Users"})}).catch(U.showError)}).catch()},submitForm:function(){console.log("submitForm")},cancelForm:function(){this.editMode=!1}},watch:{$route:function(e,t){t.params.id!==e.params.id&&this.setupComponent()}}}),be={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"el-card--username"},[e._v(e._s(e.user.username))]),e._v(" "),e.isAdmin&&!e.editMode?r("el-button",{staticClass:"el-button--edit",attrs:{type:"text"},on:{click:e.editButtonPressed}},[e._v("\n                Edit\n            ")]):e._e()],1),e._v(" "),e.editMode?[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"profileForm",attrs:{model:e.profileForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[r("el-form-item",{attrs:{prop:"username",label:"You can change username"}},[r("el-input",{attrs:{placeholder:"Username"},model:{value:e.profileForm.username,callback:function(t){e.$set(e.profileForm,"username",t)},expression:"profileForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password",label:"… and password"}},[r("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.profileForm.password,callback:function(t){e.$set(e.profileForm,"password",t)},expression:"profileForm.password"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Update profile")]),e._v(" "),r("el-button",{on:{click:e.cancelForm}},[e._v("Cancel")])],1)],1)]:e._l(e.user,function(t,n){return r("div",{key:n},[e._v("\n                "+e._s(n+": "+("exp"===n?new Date(1e3*t):t))+"\n            ")])})],2),e._v(" "),e.isAdmin&&!e.isSelf?r("el-button",{staticClass:"el-button--delete",attrs:{type:"danger"},on:{click:e.deleteButtonPressed}},[e._v("\n        Delete user\n    ")]):e._e()],1)},staticRenderFns:[]};var _e=r("VU/8")(ge,be,!1,function we(e){r("f/sI")},"data-v-d5239816",null).exports,Fe=n.default.extend({name:"Settings"}),xe={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Settings")])},staticRenderFns:[]};var ye=r("VU/8")(Fe,xe,!1,function Oe(e){r("0bdn")},"data-v-6e43dc09",null).exports,ke=n.default.extend({name:"Users",data:function(){return{user:f.state.user,busy:!1,usersData:[],isAdmin:!1}},created:function(){var e=this;B.dispatchGetRoles(),this.isAdmin=he(this.user),this.isAdmin?(this.busy=!0,D.getUsers().then(function(t){return e.usersData=t}).catch(U.showError).then(function(){return e.busy=!1})):this.usersData=[this.user]},computed:{isMobile:function(){return window.innerWidth<=768},tableFields:function(){return[{prop:"id",label:"Id",minWidth:60,fixed:!0,sortable:!0},{prop:"username",label:"Name",minWidth:90,sortable:!0},{prop:"roles",label:"Roles",filters:B.state.rolesList.map(function(e){return{text:e.rolename,value:e.rolename}}),filterMethod:function(e,t){return t.roles.split(",").includes(e)}}]}},methods:{detailClick:function(e){this.$router.push({name:"Profile",params:{id:e}})},addNewUser:function(){this.$router.push({name:"Register"})},filterRole:function(e,t){return t.role===e}}}),Ue={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],attrs:{data:e.usersData,"default-sort":{prop:"id",order:"ascending"},height:e.isMobile?300:500}},[e._l(e.tableFields,function(e){return r("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,fixed:e.fixed,width:e.width,"min-width":e.minWidth,sortable:e.sortable,formatter:e.formatter,filters:e.filters,"filter-method":e.filterMethod,"filter-placement":"bottom-end"}})}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",width:e.isMobile?50:96},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.detailClick(t.row.id)}}},[e._v("Detail")])]}}])})],2),e._v(" "),e.isAdmin?r("el-button",{staticClass:"el-button--new-user",attrs:{type:"primary"},on:{click:e.addNewUser}},[e._v("\n        Add new user\n    ")]):e._e()],1)},staticRenderFns:[]};var Ae=r("VU/8")(ke,Ue,!1,function Re(e){r("x8S2")},"data-v-a6587626",null).exports,Me=n.default.extend({name:"Register",data:function(){return{busy:!1,registerForm:{username:"",password:"",roles:[]},rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}],roles:[{required:!0,message:"Please select roles",trigger:"blur"}]},rolesList:B.state.rolesList}},created:function(){B.dispatchGetRoles()},methods:{submitForm:function(){var e=this;this.$refs.registerForm.validate().then(function(){e.busy=!0;var t=e.registerForm;D.register(t.username,t.password,t.roles).then(function(){return e.$router.push({name:"Users"})}).catch(U.showError).then(function(){return e.busy=!1})}).catch(function(){return console.error("register form validation fail")})}}}),Le={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"registerForm",attrs:{model:e.registerForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:"Username"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"roles"}},[r("el-select",{attrs:{multiple:"",placeholder:"Roles"},model:{value:e.registerForm.roles,callback:function(t){e.$set(e.registerForm,"roles",t)},expression:"registerForm.roles"}},e._l(e.rolesList,function(e){return r("el-option",{key:e.id,attrs:{value:e.id,label:e.rolename}})}))],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Register")])],1)],1)},staticRenderFns:[]};var Ce=r("VU/8")(Me,Le,!1,function Ee(e){r("K6Ts")},"data-v-f835fd7e",null).exports,Se=r("Eoz/"),$e=r.n(Se),Te=n.default.extend({name:"Orders",data:function(){return{user:f.state.user,users:[],isAdmin:!1,isUser:!1,formLabelWidth:"120px",isAddingOrder:!1,orderFormVisible:!1,orderForm:{id:void 0,ordername:"",approved:!1},orderFormRules:{ordername:[{required:!0,message:"Please input Order name",trigger:"blur"}]},orderSearchString:"",tableData:[],selectedOrderId:void 0}},computed:{orders:function(){return ne.state.orders}},created:function(){var e=this;ne.dispatchGetOrders(),this.refreshTableData(),this.isAdmin=he(this.user),this.isUser=ve(this.user),this.isAdmin&&D.getUsers().then(function(t){return e.users=t}).catch(U.showError)},mounted:function(){},watch:{orders:function(){this.refreshTableData()},orderSearchString:function(){this.refreshTableData()}},methods:{refreshTableData:function(){var e=this.orders||[];if(this.orderSearchString){var t=this.orderSearchString.toLowerCase();e=e.filter(function(e){return e.ordername.toLowerCase().includes(t)})}this.tableData=e},addOrder:function(){this.orderFormVisible||(this.isAddingOrder=!0,this.orderFormVisible=!0)},editOrder:function(e){if(!this.orderFormVisible){var t=(this.orders||[]).filter(function(t){return t.id===e})[0];this.orderForm.id=t.id,this.orderForm.ordername=t.ordername,this.orderForm.approved=t.approved,this.orderFormVisible=!0}},deleteOrder:function(e,t){U.showConfirmMessage("Delete order '"+t+"'","Are you sure?").then(function(){return ne.dispatchDeleteOrder({orderId:e}).catch(U.showError)}).catch(function(){})},cancelOrderForm:function(){this.orderFormVisible&&(this.orderFormVisible=!1),this.isAddingOrder=!1,this.$refs.orderForm.resetFields()},confirmOrderForm:function(){var e=this,t=this.$refs.orderForm;t.validate().then(function(){console.log("order form validation success");var r=e.orderForm;e.isAddingOrder?ne.dispatchAddOrder({ordername:r.ordername}).then(function(){t.resetFields(),e.isAddingOrder=!1,e.orderFormVisible=!1}).catch(U.showError):ne.dispatchUpdateOrder({orderId:r.id,ordername:r.ordername,approved:r.approved}).then(function(){t.resetFields(),e.orderFormVisible=!1}).catch(U.showError)}).catch(function(){return console.error("order form validation fail")})},approveOrder:function(e,t){U.showConfirmMessage("Approve order '"+t+"'","Are you sure?").then(function(){return ne.dispatchUpdateOrder({orderId:e,ordername:t,approved:!0}).catch(U.showError)}).catch(function(){})},dateFormatter:function(e){return $e()(e.created_at,"DD MMM YYYY, HH:mm:ss")},usernameForUserId:function(e){return(this.users.find(function(t){return t.id===e})||{username:"Unknown user"}).username},userFilter:function(){return this.users.filter(function(e){return e.roles.includes("user")}).map(function(e){return{text:e.username,value:e.id}})},userFilterMethod:function(e,t){return t.user_id===e}}}),Pe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isUser?r("el-row",[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus"},on:{click:e.addOrder}},[e._v("Add order")])],1):e._e(),e._v(" "),r("el-row",[r("el-input",{staticClass:"order-search-string",attrs:{placeholder:"Search orders by name","prefix-icon":"el-icon-search"},model:{value:e.orderSearchString,callback:function(t){e.orderSearchString=t},expression:"orderSearchString"}})],1),e._v(" "),r("el-table",{attrs:{data:e.tableData,"default-sort":{prop:"id",order:"descending"}}},[r("el-table-column",{attrs:{prop:"id",label:"Id",width:"60px",sortable:!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"created_at",label:"Date",sortable:!0,formatter:e.dateFormatter}}),e._v(" "),r("el-table-column",{attrs:{prop:"ordername",label:"Name",sortable:!0}}),e._v(" "),e.isAdmin?r("el-table-column",{attrs:{prop:"user_id",label:"User",sortable:!0,filters:e.userFilter(),"filter-method":e.userFilterMethod},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.usernameForUserId(t.row.user_id))+"\n            ")]}}])}):e._e(),e._v(" "),r("el-table-column",{attrs:{prop:"approved",label:"Approved",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.approved?[r("span",{staticClass:"order-approved"},[r("i",{staticClass:"el-icon-success"})])]:[e.isAdmin?r("el-button",{attrs:{type:"primary"},on:{click:function(r){e.approveOrder(t.row.id,t.row.ordername)}}},[e._v("Approve")]):r("span",{staticClass:"order-waiting-for-approve"},[r("i",{staticClass:"el-icon-question"})])]]}}])}),e._v(" "),e.isUser?r("el-table-column",{attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.approved?void 0:[r("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(r){e.editOrder(t.row.id)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(r){e.deleteOrder(t.row.id,t.row.ordername)}}})]}}])}):e._e()],1),e._v(" "),r("el-dialog",{attrs:{title:e.isAddingOrder?"Add order":"Edit order",visible:e.orderFormVisible,"append-to-body":!0},on:{"update:visible":function(t){e.orderFormVisible=t}}},[r("el-form",{ref:"orderForm",attrs:{model:e.orderForm,rules:e.orderFormRules}},[r("el-form-item",{attrs:{label:"Order name","label-width":e.formLabelWidth,required:"",prop:"ordername"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.orderForm.ordername,callback:function(t){e.$set(e.orderForm,"ordername",t)},expression:"orderForm.ordername"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelOrderForm}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmOrderForm}},[e._v("Confirm")])],1)],1)],1)},staticRenderFns:[]};var De=r("VU/8")(Te,Pe,!1,function je(e){r("WjiO")},"data-v-d26307ba",null).exports;n.default.use(A.a);var qe=[{path:"/",name:"Main",component:le,meta:{localname:"Main page"}},{path:"/login",name:"Login",component:fe,meta:{localname:"Login page"}},{path:"/profile/:id?",name:"Profile",component:_e,meta:{localname:"Profile page"},props:!0},{path:"/settings",name:"Settings",component:ye,meta:{localname:"Settings page"}},{path:"/users",name:"Users",component:Ae,meta:{localname:"Users page"}},{path:"/register",name:"Register",component:Ce,meta:{requiresRoles:["admin"],localname:"Register page"}},{path:"/orders",name:"Orders",component:De,meta:{localname:"Orders page"}}],Ve=new A.a({routes:qe});Ve.beforeEach(function(e,t,r){var n=!!f.state.user;return n?n?E.checkLifetime().then(function(){return"Login"===e.name?r({name:"Main"}):function t(e,r,n){if(!e.meta.requiresRoles)return n();f.state.user.roles.split(",").some(function(t){return e.meta.requiresRoles.includes(t)})?n():n({name:"Main"})}(e,0,r)}).catch(function(e){return ie(),r({name:"Login"})}):void 0:"Login"!==e.name?r({name:"Login"}):r()});var Ie=Ve,Ne=n.default.extend({name:"TheHeader",data:function(){return{md:new w.a(navigator.userAgent)}},computed:{user:function(){return f.state.user}},methods:{handleCommand:function(e){if("Logout"===e)return U.showConfirmMessage("Logout","Are you sure to logout?").then(function(){ie(),Ie.push({name:"Login"})}).catch(function(){});Ie.push({name:e})}}}),ze={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-header",{staticClass:"the-header"},[r("el-row",[r("el-col",{attrs:{span:8}},[r("h4",[e._v("The Header")])]),e._v(" "),r("el-col",{attrs:{span:16}},[r("el-row",{attrs:{type:"flex",justify:"end"}},[e.user?r("el-dropdown",{attrs:{trigger:e.md.mobile()?"click":"hover"},on:{command:e.handleCommand}},[r("div",{staticClass:"el-dropdown-link"},[r("span",[e._v(e._s(e.user.username))]),e._v(" "),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:"Profile"}},[r("i",{staticClass:"el-icon-info el-icon--left"}),e._v(" "),r("span",[e._v("Profile")])]),e._v(" "),r("el-dropdown-item",{attrs:{command:"Settings"}},[r("i",{staticClass:"el-icon-setting el-icon--left"}),e._v(" "),r("span",[e._v("Settings")])]),e._v(" "),r("el-dropdown-item",{attrs:{command:"Logout",divided:""}},[r("i",{staticClass:"el-icon-arrow-right el-icon--left"}),e._v(" "),r("span",[e._v("Logout")])])],1)],1):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var We=r("VU/8")(Ne,ze,!1,function Be(e){r("TdF4")},"data-v-73176743",null).exports,Ye=n.default.extend({name:"TheFooter"}),Ge={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-footer",[t("h3",[this._v("The Footer")])])},staticRenderFns:[]};var He=r("VU/8")(Ye,Ge,!1,function Ke(e){r("5JrK")},"data-v-6fc60404",null).exports,Je=n.default.extend({name:"TheLayout",components:{TheHeader:We,TheAside:g,TheFooter:He},computed:{isAuthorized:function(){return!!f.state.user}}}),Ze={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isAuthorized?r("el-container",[r("the-header"),e._v(" "),r("the-aside"),e._v(" "),r("el-main",[r("h1",[e._v(e._s(this.$router.currentRoute.meta.localname))]),e._v(" "),e._t("default")],2),e._v(" "),r("the-footer")],1):r("el-container",[e._t("default")],2)},staticRenderFns:[]};var Qe=r("VU/8")(Je,Ze,!1,function Xe(e){r("g7Mu")},"data-v-5f79bcc0",null).exports,et=n.default.extend({name:"App",components:{TheLayout:Qe}}),tt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("the-layout",[t("router-view")],1)],1)},staticRenderFns:[]};var rt=r("VU/8")(et,tt,!1,function nt(e){r("PNa4")},null,null).exports,ot=r("wUZ8"),st=r.n(ot);r("tvR6"),r("d8/S");n.default.config.productionTip=!1,n.default.use(x.a,{locale:st.a}),n.default.use(O.a),console.log(Object({NODE_ENV:"production"})),new n.default({el:"#app",router:Ie,store:se,render:function(e){return e(rt)}})},x8S2:function(e,t){}},["x35b"]);
//# sourceMappingURL=app.c3491c5a6aec354cbb94.js.map